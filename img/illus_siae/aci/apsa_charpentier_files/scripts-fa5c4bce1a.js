$(document).ready(function(){function e(){$(".sponsor-container").length&&$(".sponsor-container").height($("#results-grid").height())}function o(){$(document).height()-c.height()<=c.scrollTop()+300?(a(!0),d=setTimeout(function(){o()},100)):clearTimeout(d)}function t(){u||(u=!0,$.ajax({type:"POST",url:window.loadMoreReferralUrl,data:{slice:m,slug:window.currentSearchQuery},success:function(e){if(u=!1,m++,e.length>0)for(i in e){var o='<div class="sponsor-grid-item" style="background-image: url('+e[i].previewUrl+"); height: "+Math.floor(e[i].height)+'px;"><a class="open-sponsor-image" href="'+e[i].link+'" target="_blank" rel="nofollow"></a></div>';$("#sponsor-end-of-list").before(o)}}}))}function n(e){$.ajax({type:"POST",url:window.loadMoreReferralUrl,data:{slice:1,limit:100,slug:window.currentSearchQuery?window.currentSearchQuery:"landscape"},success:function(o){var t="",i=[],n=o.length;if(n>0)if(n<=5)for(var a in o)i.push(o[a]);else for(;i.length<5;){var r=Math.floor(Math.random()*o.length);i.push(o[r]),o.splice(r,1)}if(i.length>0){$("#"+e+" .collage-of-images").show();for(var l in i)t+='<div class="img-display"><a class="open-image" href="'+i[l].link+'" target="_blank" rel="nofollow"><img src="'+i[l].previewUrl+'" alt=""/></a></div>'}else $("#"+e+" .collage-of-images").hide();$("#"+e+" .img-collage").html(t)}})}function a(o){return $(document).height()>c.height()&&!o?void clearTimeout(l):void(h||g||(h=!0,$("#loading").show(),$("#no-images").hide(),$.ajax({type:"POST",url:window.loadMoreUrl,data:{slice:s,slug:window.currentSearchQuery},success:function(o){if($("#loading").hide(),h=!1,s++,o.length>0)for(i in o){var t='<div class="grid-item"><a class="open-image" href="#" data-id="" data-author="" data-download=""></a>';void 0!=window.hideOverlay&&window.hideOverlay||(t+='<div class="overlay">',t+="</div>"),t+="</div>";var n=$(t),a=n.find("a.open-image"),l=n.find(".overlay a");void 0!==o[i].thumbUrl?n.css("background-image","url("+o[i].thumbUrl+")"):n.css("background-image","url("+o[i].previewUrl+")"),o[i].width>0&&o[i].height>0&&n.css("height",Math.floor(window.itemWidth*o[i].height/o[i].width)+"px"),void 0!=window.hideOverlay&&window.hideOverlay?(a.attr("href",o[i].link),a.attr("rel","nofollow")):a.attr("href","#"+o[i].id),a.attr("data-id",o[i].id),a.attr("data-author","local"!=o[i].provider?o[i].user+" @ "+o[i].provider:o[i].user),"pexels"===o[i].provider||"getty"===o[i].provider?a.attr("data-download",o[i].link):a.attr("data-download",o[i].imageUrl),o[i].link&&a.attr("data-link",o[i].link),l.attr("target","_blank"),"pexels"===o[i].provider||"getty"===o[i].provider?l.attr("href",o[i].link):l.attr("href",o[i].imageUrl),r.masonry().append(n).masonry("appended",n);var d=$(".lightbox:last").clone();d.length&&(d.attr("id",o[i].id),$(".lightbox-image",d).attr("data-image",o[i].previewUrl),$(".lightbox").last().after(d[0].outerHTML))}else g=!0,$("#no-images").show();e()}})))}window.location.href.split("#")[0]!=window.location.href&&(window.location.href=window.location.href.split("#")[0]),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});var r=$(".grid").masonry({itemSelector:".grid-item",columnWidth:".grid-sizer",gutter:".gutter-sizer",percentPosition:!0,originLeft:!0});r.imagesLoaded().progress(function(){r.masonry("layout")}),$(".ham-menu").on("click",function(){$(".collapsed-menu").toggleClass("collapsed-menu-open")}),$(".trigger").on("click",function(){return $(".modal-wrapper").toggleClass("open"),$(".homepage").toggleClass("overflow-body"),!1}),$(document).on("click",".open-image",function(){var e=$(this).data("id");$(this).data("link")&&""!=$(this).data("link")?$(".lightbox-bottom .image-author").html("<a href='"+$(this).data("link")+"' target='_blank' rel='nofollow'>by "+$(this).data("author")+"</a>"):$(".lightbox-bottom .image-author").html("by "+$(this).data("author")),$(".lightbox-bottom .download-btn").attr("href",$(this).data("download"));var o=$("#"+e+" .lightbox-image").data("image");if($(".lightbox-bottom img").length)$(".lightbox-bottom img").attr("src",o);else{var t=$('<img src="'+o+'" alt=""/>');$("#"+e+" .lightbox-image>img").each(function(e,o){o.remove()}),$("#"+e+" .lightbox-image").prepend(t)}n(e)}),$(document).on("touchstart",".lightbox",function(e){documentClick=!0}),$(document).on("touchmove",".lightbox",function(e){documentClick=!1}),$(document).on("click touchend",".lightbox",function(e){"click"==e.type&&(documentClick=!0),documentClick&&(window.location.href="#!")}),$(document).on("click touchstart",".download-btn, .image-author",function(e){e.stopPropagation()}),$(document).on("click",".download-btn",function(){if(Cookie.Read("downloadedLinks"))var e=Cookie.Read("downloadedLinks");else var e=0;return e<2&&!Cookie.Read("sharedLink")&&($(".thanks-modal-wrapper").addClass("open"),Cookie.Create("downloadedLinks",parseInt(e)+1,365)),!0}),$(document).on("click",".social-buttons a",function(){return Cookie.Create("sharedLink",!0,365),!0}),$(".close-modal-btn").on("click",function(){return $(".thanks-modal-wrapper").removeClass("open"),!1}),$(document).on("click",".discount-section",function(e){return e.preventDefault(),!1}),$(document).on("click",".img-collage img",function(e){e.stopPropagation()}),e();var l,d,s=2,c=$(window),h=!1,g=!1,u=!1,m=2;window.loadMoreUrl&&(c.scroll(function(){$(document).height()-c.height()<=c.scrollTop()+300&&a(!0),$("#sponsor-end-of-list").length&&$("#sponsor-end-of-list").offset().top-$(document).height()<=500&&t()}),l=setTimeout(function(){a(!1)},500)),o()});var Cookie={Create:function(e,o,t){var i="";if(t){var n=new Date;n.setTime(n.getTime()+24*t*60*60*1e3),i="; expires="+n.toGMTString()}document.cookie=e+"="+o+i+"; path=/"},Read:function(e){for(var o=e+"=",t=document.cookie.split(";"),i=0;i<t.length;i++){for(var n=t[i];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(o))return n.substring(o.length,n.length)}return null},Erase:function(e){Cookie.create(e,"",-1)}},config={childList:!0,subtree:!0,attributes:!1,characterData:!1},observer=new MutationObserver(function(e){e.forEach(function(e){if(e.addedNodes)for(var o=0;o<e.addedNodes.length;o++){var t=e.addedNodes[o];void 0!==t.id&&"_flexbar_"===t.id&&(document.getElementById("_flexbar_").style.width="100%",document.getElementById("_flexbar_").style.position="fixed",document.getElementById("_flexbar_").style.top="0",document.getElementById("_flexbar_").style.zIndex="9999",document.getElementsByClassName("navigation")[0].style.top="85px",document.getElementsByTagName("body")[0].style.paddingTop="168px",observer.disconnect())}})});observer.observe(document.body,config);